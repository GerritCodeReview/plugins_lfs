{
  "comments": [
    {
      "key": {
        "uuid": "fa249f49_2cd98b87",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-05-23T07:52:41Z",
      "side": 1,
      "message": "Is this thread safe? Looks like there are some race conditions here:\nThe assumption at the line 91 is that the lock wasn\u0027t present (lock \u003d\u003d null), however between the line 87 and 91 another thread could have created a lock.",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4eb466cd_b762d071",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2017-05-23T10:13:29Z",
      "side": 1,
      "message": "it is not but it serves the purpose of simple API check (I was calling endpoints from Git client); see https://gerrit-review.googlesource.com/?polygerrit\u003d0#/c/105856/7/src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsProjectLocks.java createMethod - it resolves to LockFile object in order to make sure that it is not locked by the other thread",
      "parentUuid": "fa249f49_2cd98b87",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2ac4dfb2_9204d774",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-05-23T10:56:44Z",
      "side": 1,
      "message": "OK, only one thread can successfully create (JGit) LockFile instance.\n\nBut then what is the purpose of the check in 86-89?\nIt doesn\u0027t really bring anything because:\n* the lock may be present at line 86 and may be released just before throwing the exception at the line 88\n* the lock may be not-present at line 86 but already present before line 91\n\nThe only thing that matters is which thread first succeeds to create the LockFile.\nMy proposal is that the very first action must be creation of the LockFile.",
      "parentUuid": "4eb466cd_b762d071",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "63df4117_3919a125",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2017-05-23T11:58:42Z",
      "side": 1,
      "message": "here it doesn\u0027t really matter as it is overwritten in the following patch - let\u0027s move discussion there :D",
      "parentUuid": "2ac4dfb2_9204d774",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b761d96f_32311fde",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2017-05-23T11:59:22Z",
      "side": 1,
      "message": "see comment: https://gerrit-review.googlesource.com/?polygerrit\u003d0#/c/105856/7/src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsProjectLocks.java@105",
      "parentUuid": "63df4117_3919a125",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "634ecc9b_155fd024",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2017-05-23T14:24:50Z",
      "side": 1,
      "message": "Please don\u0027t force me to switch to the old UI ;-)",
      "parentUuid": "b761d96f_32311fde",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b86a8a6f_42f4bbb8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsLocksHandler.java",
        "patchSetId": 7
      },
      "lineNbr": 92,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2017-05-23T14:51:29Z",
      "side": 1,
      "message": "https://gerrit-review.googlesource.com/c/105856/7/src/main/java/com/googlesource/gerrit/plugins/lfs/locks/LfsProjectLocks.java#105 :)",
      "parentUuid": "634ecc9b_155fd024",
      "range": {
        "startLine": 86,
        "startChar": 0,
        "endLine": 92,
        "endChar": 28
      },
      "revId": "2bdd714208b6fe5ea5cfb926019878195323f166",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}